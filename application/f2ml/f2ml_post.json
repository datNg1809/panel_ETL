{
  "GENERAL": {
    "logger_name": "daily_f2ml_import",
    "input_filename": "./data/fichier_cote_vf_f2ml.csv",
    "output_filename": "",
    "context": "f2ml",
    "global_index": "VIN"
  },
  "enrichment_params": {
    "RPI": {
      "CITROEN": {
        "VP": {
          "coeff": "0.845",
          "Couleur": "0.955",
          "ajustement": "0.32",
          "Auto-ecole": "0.92"
        },
        "VU": {
          "coeff": "0.86",
          "Couleur": "0.97",
          "ajustement": "0.32",
          "Auto-ecole": "0.92"
        },
        "VUP": {
          "coeff": "0.78",
          "Couleur": "0.87",
          "ajustement": "0.32",
          "Auto-ecole": "0.92"
        }
      },
      "PEUGEOT": {
        "VP": {
          "coeff": "0.8456",
          "Couleur": "0.97",
          "ajustement": "0.32",
          "Auto-ecole": "0.92"
        },
        "VU": {
          "coeff": "0.874",
          "Couleur": "1",
          "ajustement": "0.32",
          "Auto-ecole": "0.92"
        },
        "VUP": {
          "coeff": "0.81",
          "Couleur": "1",
          "ajustement": "0.32",
          "Auto-ecole": "0.92"
        }
      },
      "DS AUTOMOBILES": {
        "VP": {
          "coeff": "0.865",
          "Couleur": "1",
          "ajustement": "0.4",
          "Auto-ecole": "0.92"
        },
        "VU": {
          "coeff": "0.81",
          "Couleur": "1",
          "ajustement": "0.4",
          "Auto-ecole": "0.92"
        },
        "VUP": {
          "coeff": "0.85",
          "Couleur": "0.98",
          "ajustement": "0.4",
          "Auto-ecole": "0.92"
        }
      }
    },
    "AMBITION": {
      "2015": "0",
      "2016": "0",
      "2017": "0",
      "2018": "0",
      "2019": "0.003",
      "2020": "0.0055",
      "2021": "0.008",
      "2022": "0.0105",
      "2023": "0.013",
      "2024": "0.013",
      "2025": "0.013",
      "2026": "0.013"
    },
    "DIESEL": {
      "2015": "0",
      "2016": "0",
      "2017": "0",
      "2018": "0",
      "2019": "0.03",
      "2020": "0.055",
      "2021": "0.06",
      "2022": "0.06",
      "2023": "0.06",
      "2024": "0.06",
      "2025": "0.06",
      "2026": "0.06"
    }
  },
  "enrichment": [
    {
      "name": "compute_year",
      "target": "YEARVR"
    },
    {
      "name": "compute_first_rpi",
      "target": "VERIF_RPI_MARQUE_GENRE"
    },
    {
      "name": "compute_sur_km",
      "target": "VERIF_SURKM"
    },
    {
      "name": "compute_ambition_diesel_effect",
      "target": "VERIF_RPI_AMBITION"
    },
    {
      "name": "compute_rpi_brut",
      "target": "VERIF_RPI_BRUT"
    },
    {
      "name": "compute_rpi_final",
      "target": "VERIF_RPI_FINAL"
    },
    {
      "name": "compute_depreciation",
      "target": "DEPRECIATION"
    },
    {
      "name": "compute_b2c_future",
      "target": "VERIF_B2C_FUTURE"
    },
    {
      "name": "compute_b2b_ambition",
      "target": "VERIF_B2C_AMBITION"
    },
    {
      "name": "compute_is_observable",
      "target": "OBSERVABLES_OK"
    }
  ],
  "expectations": [
    {
      "expectation_type": "expect_quotation_mode_to_be_in_specified_ratio",
      "kwargs": {
        "column": "TYPE",
        "nb_bas_mcclbp": 90,
        "ref_columns": [
          "ref",
          "mcclbp"
        ]
      },
      "logs": {
        "keyword": "MCCLBP_REF"
      }
    },
    {
      "expectation_type": "expect_column_values_to_not_be_in_set",
      "kwargs": {
        "column": "B2C_TODAY_TTC",
        "values_set": [
          0
        ]
      }
    },
    {
      "expectation_type": "expect_column_values_to_not_be_in_set",
      "kwargs": {
        "column": "B2C_FUTUR_TTC",
        "values_set": [
          0
        ]
      }
    },
    {
      "expectation_type": "expect_column_pair_values_A_to_be_greater_than_B",
      "kwargs": {
        "column_A": "B2C_TODAY_TTC",
        "column_B": "B2C_FUTUR_TTC",
        "or_equal": true
      }
    },
    {
      "expectation_type": "expect_returning_row_count",
      "kwargs": {
        "column": "VIN"
      },
      "logs": {
        "keyword": "ROW_COUNT"
      }
    },
    {
      "expectation_type": "expect_table_row_count_to_be_between_depending_on_day",
      "kwargs": {
        "column": "VIN",
        "min_day_of_week": 10,
        "min_not_day_of_week": 10,
        "maximum": 300
      }
    },
    {
      "expectation_type": "expect_values_to_be_close",
      "kwargs": {
        "tolerance": 0.001,
        "column_a": "AMBITION",
        "column_b": "VERIF_RPI_AMBITION",
        "vin": "VIN"
      },
      "logs": {
        "keyword": "AMBITION"
      }
    },
    {
      "expectation_type": "expect_values_to_be_close",
      "kwargs": {
        "tolerance": 0.01,
        "column_a": "RPI_BRUT",
        "column_b": "VERIF_RPI_BRUT",
        "vin": "VIN"
      }
    },
    {
      "expectation_type": "expect_values_to_be_close",
      "kwargs": {
        "tolerance": 150,
        "column_a": "B2C_FUTUR_TTC",
        "column_b": "VERIF_B2C_FUTURE",
        "vin": "VIN"
      }
    },
    {
      "expectation_type": "expect_values_to_be_close",
      "kwargs": {
        "tolerance": 150,
        "column_a": "B2B_AMBITION_TTC",
        "column_b": "VERIF_B2C_AMBITION",
        "vin": "VIN"
      }
    },
    {
      "expectation_type": "expect_vehicles_observable",
      "kwargs": {
        "column": "OBSERVABLES_OK",
        "ratio": 0.90
      },
      "logs" : {
        "keyword": "OBSERVABLE"
      }
    }
  ]
}









